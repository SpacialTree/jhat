
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/plot_b_nircam.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_plot_b_nircam.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_plot_b_nircam.py:


===========
JWST NIRCAM
===========

Aligning JWST/NIRCAM images with JHAT.

.. GENERATED FROM PYTHON SOURCE LINES 10-14

An example NIRCam Dataset is downloaded, and then a series of
alignment methods are used. For more information on the
key parameters used for alignment see 
:ref:`params:Useful Parameters`.

.. GENERATED FROM PYTHON SOURCE LINES 14-33

.. code-block:: default

   

    import sys,os,glob
    from astropy.io import fits
    from astropy.table import Table
    from astropy.nddata import extract_array
    from astropy.coordinates import SkyCoord
    from astropy import wcs
    from astropy.wcs.utils import skycoord_to_pixel
    from astropy import units as u
    import numpy as np
    import matplotlib.pyplot as plt
    from astroquery.mast import Observations
    from astropy.visualization import (simple_norm,LinearStretch)

    import jhat
    from jhat import jwst_photclass,st_wcs_align









.. GENERATED FROM PYTHON SOURCE LINES 34-43

------------------
Relative Alignment
------------------

**Download some Data**

For this example we download 2 JWST NIRCam images from MAST. They're
the same field but different filters. Note that 
the code will also work for level 3 data images.

.. GENERATED FROM PYTHON SOURCE LINES 44-56

.. code-block:: default

    obs_table1 = Observations.query_criteria(obs_id='jw02107-o041_t019_nircam_clear-f200w')
    data_products_by_obs = Observations.get_product_list(obs_table1)
    data_products_by_obs = data_products_by_obs[data_products_by_obs['calib_level']==2]
    data_products_by_obs = data_products_by_obs[data_products_by_obs['productSubGroupDescription']=='CAL'][0]
    Observations.download_products(data_products_by_obs,extension='fits')

    obs_table2 = Observations.query_criteria(obs_id='jw02107-o041_t019_nircam_clear-f360m')
    data_products_by_obs = Observations.get_product_list(obs_table2)
    data_products_by_obs = data_products_by_obs[data_products_by_obs['calib_level']==2]
    data_products_by_obs = data_products_by_obs[data_products_by_obs['productSubGroupDescription']=='CAL'][0]
    Observations.download_products(data_products_by_obs,extension='fits')





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    INFO: Found cached file ./mastDownload/JWST/jw02107041001_02101_00001_nrcb1/jw02107041001_02101_00001_nrcb1_cal.fits with expected size 117538560. [astroquery.query]
    INFO: Found cached file ./mastDownload/JWST/jw02107041001_02101_00001_nrcblong/jw02107041001_02101_00001_nrcblong_cal.fits with expected size 117538560. [astroquery.query]


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><i>Table length=1</i>
    <table id="table140641675343856" class="table-striped table-bordered table-condensed">
    <thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
    <thead><tr><th>str98</th><th>str8</th><th>object</th><th>object</th></tr></thead>
    <tr><td>./mastDownload/JWST/jw02107041001_02101_00001_nrcblong/jw02107041001_02101_00001_nrcblong_cal.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
    </table></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 57-59

**Examine the Reference Image**


.. GENERATED FROM PYTHON SOURCE LINES 59-71

.. code-block:: default


    ref_image = glob.glob('mastDownload/JWST/*nrcb1*/*cal.fits')[0]

    ref_fits = fits.open(ref_image)
    ref_data = fits.open(ref_image)['SCI',1].data
    norm1 = simple_norm(ref_data,stretch='linear',min_cut=-.5,max_cut=3)

    plt.imshow(ref_data, origin='lower',
                          norm=norm1,cmap='gray')
    plt.gca().tick_params(labelcolor='none',axis='both',color='none')
    plt.show()




.. image-sg:: /examples/images/sphx_glr_plot_b_nircam_001.png
   :alt: plot b nircam
   :srcset: /examples/images/sphx_glr_plot_b_nircam_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 72-78

**Zoom in to see the offset**

Here add an artificial offset to the wcs, and then we see the 
same star in both images at the same ra/dec
location, demonstrating a large offset between
the images.  

.. GENERATED FROM PYTHON SOURCE LINES 78-105

.. code-block:: default

    star_location = SkyCoord('23:09:41.0532','-43:26:41.128',unit=(u.hourangle,u.deg))
    align_image = glob.glob('mastDownload/JWST/*long*/*cal.fits')[0]
    align_fits = fits.open(align_image)
    align_fits['SCI',1].header['CRPIX1']+=1
    align_fits['SCI',1].header['CRPIX2']+=1
    align_fits.writeto(align_image,overwrite=True)

    align_data = fits.open(align_image)['SCI',1].data
    ref_y,ref_x = skycoord_to_pixel(star_location,wcs.WCS(ref_fits['SCI',1],ref_fits))
    align_y,align_x = skycoord_to_pixel(star_location,wcs.WCS(align_fits['SCI',1],align_fits))

    ref_cutout = extract_array(ref_data,(11,11),(ref_x,ref_y))
    align_cutout = extract_array(align_data,(11,11),(align_x,align_y))
    norm1 = simple_norm(ref_cutout,stretch='linear',min_cut=-.5,max_cut=3)
    norm2 = simple_norm(align_cutout,stretch='linear',min_cut=-.5,max_cut=3)
    fig,axes = plt.subplots(1,2)
    axes[0].imshow(ref_cutout, origin='lower',
                          norm=norm1,cmap='gray')
    axes[1].imshow(align_cutout, origin='lower',
                          norm=norm2,cmap='gray')
    axes[0].set_title('Reference')
    axes[1].set_title('To Align')
    axes[0].tick_params(labelcolor='none',axis='both',color='none')
    axes[1].tick_params(labelcolor='none',axis='both',color='none')

    plt.show()




.. image-sg:: /examples/images/sphx_glr_plot_b_nircam_002.png
   :alt: Reference, To Align
   :srcset: /examples/images/sphx_glr_plot_b_nircam_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'datfix' made the change 'Set DATE-BEG to '2022-07-06T19:16:42.721' from MJD-BEG.
    Set DATE-AVG to '2022-07-06T19:17:14.932' from MJD-AVG.
    Set DATE-END to '2022-07-06T19:17:47.142' from MJD-END'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'datfix' made the change 'Set DATE-BEG to '2022-07-06T19:16:42.721' from MJD-BEG.
    Set DATE-AVG to '2022-07-06T19:17:14.932' from MJD-AVG.
    Set DATE-END to '2022-07-06T19:17:47.142' from MJD-END'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(




.. GENERATED FROM PYTHON SOURCE LINES 106-110

**Create a Photometric Catalog for Relative Alignment**

We choose one of the images to be the reference image, and then 
create a catalog that we will use to align the other image.

.. GENERATED FROM PYTHON SOURCE LINES 110-117

.. code-block:: default


    jwst_phot = jwst_photclass()
    jwst_phot.run_phot(imagename=ref_image,photfilename='auto',overwrite=True,ee_radius=80)
    ref_catname = ref_image.replace('.fits','.phot.txt') # the default
    refcat = Table.read(ref_catname,format='ascii')
    print(refcat)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'datfix' made the change 'Set DATE-BEG to '2022-07-06T19:16:42.721' from MJD-BEG.
    Set DATE-AVG to '2022-07-06T19:17:14.932' from MJD-AVG.
    Set DATE-END to '2022-07-06T19:17:47.142' from MJD-END'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/stats/sigma_clipping.py:411: AstropyUserWarning: Input data contains invalid values (NaNs or infs), which were automatically clipped.
      warnings.warn('Input data contains invalid values (NaNs or '
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/stats/sigma_clipping.py:411: AstropyUserWarning: Input data contains invalid values (NaNs or infs), which were automatically clipped.
      warnings.warn('Input data contains invalid values (NaNs or '
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
      return dex.to(self._function_unit, np.log10(x))
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/jhat/simple_jwst_phot.py:898: RuntimeWarning: invalid value encountered in log10
      phot['magerr'] = 2.5 * np.log10(1.0 + (fluxerr/flux))
    aper_sum_5.7px annulus_median_5.7px aper_bkg_5.7px ...   x_idl      y_idl   
    -------------- -------------------- -------------- ... ---------- ----------
        119.323149             0.961823      97.417247 ...     1.3907 -31.375588
         59.615065             0.488573      49.484631 ...  18.603946 -31.271755
        124.252717             0.978947      99.151627 ... -31.055253 -31.331221
        111.337184             0.794472      80.467245 ... -18.547599 -31.350329
        103.821352             0.748522      75.813239 ... -13.204696 -31.346782
          86.68538             0.683904      69.268524 ...  11.290295  -31.30206
        109.617017             0.845722      85.658061 ...  -0.181089 -31.287797
        122.863203             0.840969      85.176686 ...   6.266776 -31.255011
        107.070957             0.853829      86.479155 ...  10.634555 -31.259936
         53.942033             0.397977      40.308682 ...   27.80494 -31.175293
               ...                  ...            ... ...        ...        ...
         46.120797              0.27309      27.659613 ...  27.465447  28.964546
        160.614283             0.491139      49.744451 ...  -1.899645  28.952451
         39.683767              0.22192      22.476954 ... -18.178584  29.362928
           1.85933               -99.99  -10127.382506 ...  -2.733332  29.759634
          18.65057               -99.99  -10127.382506 ...  20.030256   29.87687
         47.062508             0.303469       30.73658 ...   8.796715  31.022053
         35.721694             0.228997      23.193684 ...  26.612881  31.127073
         37.043319             0.197297       19.98306 ... -15.095761  31.109864
        337.958246             0.268415      27.186103 ...  -9.937287  31.082626
         49.131628              0.31229      31.629957 ...   8.547068   31.13673
         44.854071             0.246772      24.994006 ...  13.180826  31.165253
    Length = 2751 rows




.. GENERATED FROM PYTHON SOURCE LINES 118-123

**Align the second image**

The plots outputted here show the various steps used by jhat to
determine the true matching sources in the image, and the
subsequent correction needed for optimal alignment.

.. GENERATED FROM PYTHON SOURCE LINES 123-146

.. code-block:: default


    wcs_align = st_wcs_align()


    wcs_align.run_all(align_image,
    		  telescope='jwst',
    		  outsubdir='mastDownload',
              refcat_racol='ra',
              refcat_deccol='dec',
              refcat_magcol='mag',
              refcat_magerrcol='dmag',
              overwrite=True,
              d2d_max=1,
              showplots=2,
              refcatname=ref_catname,
              histocut_order='dxdy',
                  sharpness_lim=(0.3,0.9),
                  roundness1_lim=(-0.7, 0.7),
                  SNR_min= 3,
                  dmag_max=1.0,
                  objmag_lim =(14,24))





.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_003.png
         :alt: Initial cut: d2d_max=1, dmag_max=None, Nbright=None, delta_mag_lim=(None, None)
         :srcset: /examples/images/sphx_glr_plot_b_nircam_003.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_004.png
         :alt: dx, dx, dx, slope:-4.8828125000017174e-05, 3-sigma cut: 109 out of 111 left mean = -0.490 px, stdev = 0.183 px
         :srcset: /examples/images/sphx_glr_plot_b_nircam_004.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_005.png
         :alt: dy, dy, dy, slope:9.76562499999823e-05, 3-sigma cut: 102 out of 107 left mean = -0.607 px, stdev = 0.154 px
         :srcset: /examples/images/sphx_glr_plot_b_nircam_005.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_006.png
         :alt: pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction
         :srcset: /examples/images/sphx_glr_plot_b_nircam_006.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_007.png
         :alt: after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction
         :srcset: /examples/images/sphx_glr_plot_b_nircam_007.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'datfix' made the change 'Set DATE-BEG to '2022-07-06T19:16:42.721' from MJD-BEG.
    Set DATE-AVG to '2022-07-06T19:17:14.932' from MJD-AVG.
    Set DATE-END to '2022-07-06T19:17:47.142' from MJD-END'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/stats/sigma_clipping.py:411: AstropyUserWarning: Input data contains invalid values (NaNs or infs), which were automatically clipped.
      warnings.warn('Input data contains invalid values (NaNs or '
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/stats/sigma_clipping.py:411: AstropyUserWarning: Input data contains invalid values (NaNs or infs), which were automatically clipped.
      warnings.warn('Input data contains invalid values (NaNs or '
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
      return dex.to(self._function_unit, np.log10(x))
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/jhat/simple_jwst_phot.py:898: RuntimeWarning: invalid value encountered in log10
      phot['magerr'] = 2.5 * np.log10(1.0 + (fluxerr/flux))
            slope     intercept    maxval  index  d_bestguess  fwhm  multimax
    -4.882812e-03  5.000000e+00 33.721638     72     0.312407   2.2     False
    -4.833984e-03  4.950000e+00 33.745896     72     0.296685   2.2     False
    -4.785156e-03  4.900000e+00 34.084381     72     0.280963   2.2     False
    -4.736328e-03  4.850000e+00 34.877430     72     0.265241   2.2     False
    -4.687500e-03  4.800000e+00 34.877430     72     0.249519   2.0     False
    -4.638672e-03  4.750000e+00 35.371707     72     0.233797   2.0     False
    -4.589844e-03  4.700000e+00 35.033222     72     0.218075   2.0     False
    -4.541016e-03  4.650000e+00 35.200459     72     0.202352   2.0     False
    -4.492188e-03  4.600000e+00 36.610517     72     0.186630   2.0     False
    -4.443359e-03  4.550000e+00 36.478983     72     0.170908   2.0     False
    -4.394531e-03  4.500000e+00 36.828914     72     0.155186   2.0     False
    -4.345703e-03  4.450000e+00 37.167399     72     0.139464   2.0     False
    -4.296875e-03  4.400000e+00 38.290131     72     0.123742   2.0     False
    -4.248047e-03  4.350000e+00 37.951646     72     0.108020   2.0     False
    -4.199219e-03  4.300000e+00 38.290131     72     0.092298   2.0     False
    -4.150391e-03  4.250000e+00 38.784409     72     0.076576   2.0     False
    -4.101563e-03  4.200000e+00 38.784409     72     0.060854   2.0     False
    -4.052734e-03  4.150000e+00 38.338647     72     0.045132   2.0     False
    -4.003906e-03  4.100000e+00 38.334636     72     0.029410   2.0     False
    -3.955078e-03  4.050000e+00 38.229929     73     0.213688   2.0     False
    -3.906250e-03  4.000000e+00 38.278445     73     0.197965   2.0     False
    -3.857422e-03  3.950000e+00 39.891444     73     0.182243   1.6     False
    -3.808594e-03  3.900000e+00 40.058681     73     0.166521   1.6     False
    -3.759766e-03  3.850000e+00 40.225918     73     0.150799   1.6     False
    -3.710938e-03  3.800000e+00 40.827472     73     0.135077   1.6     False
    -3.662109e-03  3.750000e+00 40.994709     73     0.119355   1.6     False
    -3.613281e-03  3.700000e+00 41.333194     73     0.103633   1.6     False
    -3.564453e-03  3.650000e+00 42.141699     73     0.087911   1.6     False
    -3.515625e-03  3.600000e+00 42.950204     73     0.072189   1.6     False
    -3.466797e-03  3.550000e+00 43.117441     73     0.056467   1.6     False
    -3.417969e-03  3.500000e+00 43.117441     73     0.040745   1.6     False
    -3.369141e-03  3.450000e+00 44.395965     73     0.025023   1.6     False
    -3.320313e-03  3.400000e+00 44.718994     73     0.009301   1.6     False
    -3.271484e-03  3.350000e+00 43.703538     73    -0.006422   1.6     False
    -3.222656e-03  3.300000e+00 44.547746     73    -0.022144   1.6     False
    -3.173828e-03  3.250000e+00 45.730439     73    -0.037866   1.4     False
    -3.125000e-03  3.200000e+00 45.391954     73    -0.053588   1.4     False
    -3.076172e-03  3.150000e+00 45.861974     73    -0.069310   1.4     False
    -3.027344e-03  3.100000e+00 46.837716     73    -0.085032   1.4     False
    -2.978516e-03  3.050000e+00 46.499230     73    -0.100754   1.4     False
    -2.929688e-03  3.000000e+00 46.630764     73    -0.116476   1.4     False
    -2.880859e-03  2.950000e+00 46.068263     74     0.067802   1.4     False
    -2.832031e-03  2.900000e+00 46.406748     74     0.052080   1.4     False
    -2.783203e-03  2.850000e+00 46.431006     74     0.036358   1.4     False
    -2.734375e-03  2.800000e+00 47.406748     74     0.020636   1.4     False
    -2.685547e-03  2.750000e+00 47.912471     74     0.004914   1.4     False
    -2.636719e-03  2.700000e+00 48.418193     74    -0.010809   1.4     False
    -2.587891e-03  2.650000e+00 48.079708     74    -0.026531   1.4     False
    -2.539063e-03  2.600000e+00 48.235500     74    -0.042253   1.4     False
    -2.490234e-03  2.550000e+00 49.382490     74    -0.057975   1.4     False
    -2.441406e-03  2.500000e+00 50.927927     74    -0.073697   1.4     False
    -2.392578e-03  2.450000e+00 51.095164     74    -0.089419   1.4     False
    -2.343750e-03  2.400000e+00 51.720975     74    -0.105141   1.4     False
    -2.294922e-03  2.350000e+00 53.843708     74    -0.120863   1.2     False
    -2.246094e-03  2.300000e+00 55.289469     74    -0.136585   1.0     False
    -2.197266e-03  2.250000e+00 56.097974     74    -0.152307   1.0     False
    -2.148438e-03  2.200000e+00 56.205250     74    -0.168029   1.0     False
    -2.099609e-03  2.150000e+00 55.906479     74    -0.183751   1.2     False
    -2.050781e-03  2.100000e+00 56.882221     74    -0.199473   1.2     False
    -2.001953e-03  2.050000e+00 56.436459     74    -0.215196   1.2     False
    -1.953125e-03  2.000000e+00 56.567993     74    -0.230918   1.2     False
    -1.904297e-03  1.950000e+00 57.376498     74    -0.246640   1.2     False
    -1.855469e-03  1.900000e+00 57.205250     74    -0.262362   1.2     False
    -1.806641e-03  1.850000e+00 57.372487     74    -0.278084   1.2     False
    -1.757813e-03  1.800000e+00 56.017884     75    -0.093806   1.2     False
    -1.708984e-03  1.750000e+00 56.690843     75    -0.109528   1.2     False
    -1.660156e-03  1.700000e+00 57.499348     75    -0.125250   1.2     False
    -1.611328e-03  1.650000e+00 59.323309     75    -0.140972   1.2     False
    -1.562500e-03  1.600000e+00 59.490546     75    -0.156694   1.2     False
    -1.513672e-03  1.550000e+00 60.976022     75    -0.172416   1.2     False
    -1.464844e-03  1.500000e+00 62.724565     75    -0.188321   1.2     False
    -1.416016e-03  1.450000e+00 64.755478     75    -0.214753   1.0     False
    -1.367188e-03  1.400000e+00 65.866765     75    -0.241185   1.0     False
    -1.318359e-03  1.350000e+00 67.252565     75    -0.267617   1.0     False
    -1.269531e-03  1.300000e+00 67.323971     75    -0.294048   1.0     False
    -1.220703e-03  1.250000e+00 67.829694     75    -0.320480   1.0     False
    -1.171875e-03  1.200000e+00 66.005733     75    -0.346912   1.0     False
    -1.123047e-03  1.150000e+00 66.005733     75    -0.373343   1.0     False
    -1.074219e-03  1.100000e+00 65.125822     75    -0.399775   1.0     False
    -1.025391e-03  1.050000e+00 67.019326     76    -0.226207   1.0     False
    -9.765625e-04  1.000000e+00 68.700307     76    -0.252639   1.0     False
    -9.277344e-04  9.500000e-01 70.448851     76    -0.279070   0.8     False
    -8.789063e-04  9.000000e-01 72.065861     76    -0.305502   0.8     False
    -8.300781e-04  8.500000e-01 71.281614     76    -0.331934   1.0     False
    -7.812500e-04  8.000000e-01 73.253345     76    -0.358366   1.0     False
    -7.324219e-04  7.500000e-01 73.424593     76    -0.384797   1.0     False
    -6.835938e-04  7.000000e-01 73.930316     76    -0.411229   1.0     False
    -6.347656e-04  6.500000e-01 75.077306     76    -0.437661   1.0     False
    -5.859375e-04  6.000000e-01 73.930316     76    -0.464093   1.0     False
    -5.371094e-04  5.500000e-01 72.616088     76    -0.490524   1.0     False
    -4.882813e-04  5.000000e-01 74.504547     77    -0.316956   1.0     False
    -4.394531e-04  4.500000e-01 76.798527     77    -0.343388   1.0     False
    -3.906250e-04  4.000000e-01 78.319706     77    -0.369819   0.8     False
    -3.417969e-04  3.500000e-01 78.112755     77    -0.396251   0.8     False
    -2.929688e-04  3.000000e-01 78.451240     77    -0.422683   0.8     False
    -2.441406e-04  2.500000e-01 78.622488     77    -0.449115   0.8     False
    -1.953125e-04  2.000000e-01 80.107964     77    -0.475546   0.8     False
    -1.464844e-04  1.500000e-01 83.417400     77    -0.501978   0.8     False
    -9.765625e-05  1.000000e-01 82.437647     77    -0.528410   0.8     False
    -4.882813e-05  5.000000e-02 83.453103     77    -0.554842   0.8     False
    -1.734723e-17  1.776357e-14 81.486163     77    -0.581273   1.0     False
     4.882812e-05 -5.000000e-02 82.031600     77    -0.607705   1.0     False
     9.765625e-05 -1.000000e-01 79.813037     77    -0.634137   1.0     False
     1.464844e-04 -1.500000e-01 80.155533     77    -0.660569   1.0     False
     1.953125e-04 -2.000000e-01 78.200038     77    -0.687000   1.0     False
     2.441406e-04 -2.500000e-01 77.982168     78    -0.513432   1.0     False
     2.929687e-04 -3.000000e-01 79.674594     78    -0.539864   1.0     False
     3.417969e-04 -3.500000e-01 79.881546     78    -0.566295   1.0     False
     3.906250e-04 -4.000000e-01 81.538269     78    -0.592727   0.8     False
     4.394531e-04 -4.500000e-01 80.901013     78    -0.619159   0.8     False
     4.882812e-04 -5.000000e-01 78.607032     78    -0.645591   0.8     False
     5.371094e-04 -5.500000e-01 78.738566     78    -0.672022   0.8     False
     5.859375e-04 -6.000000e-01 76.089698     78    -0.698454   1.0     False
     6.347656e-04 -6.500000e-01 74.169906     78    -0.724886   1.0     False
     6.835937e-04 -7.000000e-01 74.508391     78    -0.751318   1.0     False
     7.324219e-04 -7.500000e-01 74.245323     78    -0.777749   1.0     False
     7.812500e-04 -8.000000e-01 73.269581     78    -0.804181   1.0     False
     8.300781e-04 -8.500000e-01 71.461076     78    -0.830613   1.0     False
     8.789062e-04 -9.000000e-01 70.705265     79    -0.657045   1.0     False
     9.277344e-04 -9.500000e-01 70.474056     79    -0.683476   1.0     False
     9.765625e-04 -1.000000e+00 70.919818     79    -0.709908   1.0     False
     1.025391e-03 -1.050000e+00 69.171274     79    -0.736340   1.0     False
     1.074219e-03 -1.100000e+00 67.063998     79    -0.762771   1.2     False
     1.123047e-03 -1.150000e+00 68.318264     79    -0.789203   1.0     False
     1.171875e-03 -1.200000e+00 68.489512     79    -0.815635   1.0     False
     1.220703e-03 -1.250000e+00 69.504968     79    -0.842067   1.0     False
     1.269531e-03 -1.300000e+00 67.696463     79    -0.868498   1.0     False
     1.318359e-03 -1.350000e+00 67.094910     79    -0.894930   1.0     False
     1.367187e-03 -1.400000e+00 67.262147     79    -0.921362   1.0     False
     1.416016e-03 -1.450000e+00 65.703897     80    -0.747794   1.0     False
     1.464844e-03 -1.500000e+00 64.819976     80    -0.774225   1.0     False
     1.513672e-03 -1.550000e+00 64.871135     80    -0.800657   1.0     False
     1.562500e-03 -1.600000e+00 63.859690     80    -0.827089   1.0     False
     1.611328e-03 -1.650000e+00 62.242680     80    -0.853521   1.2     False
     1.660156e-03 -1.700000e+00 62.349956     80    -0.879952   1.2     False
     1.708984e-03 -1.750000e+00 63.066641     80    -0.906384   1.2     False
     1.757812e-03 -1.800000e+00 62.803573     80    -0.932816   1.2     False
     1.806641e-03 -1.850000e+00 61.656582     80    -0.959247   1.0     False
     1.855469e-03 -1.900000e+00 59.872336     80    -0.985679   1.0     False
     1.904297e-03 -1.950000e+00 57.825021     80    -1.012111   1.0     False
     1.953125e-03 -2.000000e+00 57.299051     81    -0.838543   1.0     False
     2.001953e-03 -2.050000e+00 56.454843     81    -0.864974   1.0     False
     2.050781e-03 -2.100000e+00 56.945110     81    -0.891406   1.0     False
     2.099609e-03 -2.150000e+00 57.219623     81    -0.917838   1.2     False
     2.148437e-03 -2.200000e+00 57.243881     81    -0.944270   1.2     False
     2.197266e-03 -2.250000e+00 56.773862     81    -0.970701   1.2     False
     2.246094e-03 -2.300000e+00 55.535051     81    -0.997133   1.2     False
     2.294922e-03 -2.350000e+00 54.726546     81    -1.023565   1.2     False
     2.343750e-03 -2.400000e+00 52.861925     81    -1.049997   1.2     False
     2.392578e-03 -2.450000e+00 52.296241     81    -1.076428   1.2     False
     2.441406e-03 -2.500000e+00 52.825608     82    -0.902860   1.2     False
     2.490234e-03 -2.550000e+00 52.180163     81    -1.129292   1.2     False
     2.539062e-03 -2.600000e+00 52.936896     82    -0.955723   1.2     False
     2.587891e-03 -2.650000e+00 52.124380     82    -0.982155   1.2     False
     2.636719e-03 -2.700000e+00 49.794696     82    -1.008587   1.4     False
     2.685547e-03 -2.750000e+00 49.870114     82    -1.035019   1.4     False
     2.734375e-03 -2.800000e+00 50.077065     82    -1.061450   1.4     False
     2.783203e-03 -2.850000e+00 49.268560     82    -1.087882   1.4     False
     2.832031e-03 -2.900000e+00 47.783084     82    -1.114314   1.4     False
     2.880859e-03 -2.950000e+00 47.950322     82    -1.140746   1.2     False
     2.929687e-03 -3.000000e+00 46.313065     82    -1.167177   1.2     False
     2.978516e-03 -3.050000e+00 47.808005     83    -0.993609   1.4     False
     3.027344e-03 -3.100000e+00 46.529480     83    -1.020041   1.4     False
     3.076172e-03 -3.150000e+00 46.880779     83    -1.046473   1.4     False
     3.125000e-03 -3.200000e+00 46.406748     83    -1.072904   1.4     False
     3.173828e-03 -3.250000e+00 45.949542     83    -1.099336   1.4     False
     3.222656e-03 -3.300000e+00 45.479522     83    -1.125768   1.4     False
     3.271484e-03 -3.350000e+00 45.009503     83    -1.152199   1.4     False
     3.320312e-03 -3.400000e+00 43.093722     83    -1.178631   1.4     False
     3.369141e-03 -3.450000e+00 42.886771     83    -1.205063   1.6     False
     3.417969e-03 -3.500000e+00 42.623869     83    -1.231495   1.6     False
     3.466797e-03 -3.550000e+00 42.802551     83    -1.257926   1.6     False
     3.515625e-03 -3.600000e+00 42.006860     83    -1.284358   1.6     False
     3.564453e-03 -3.650000e+00 42.213811     83    -1.310790   1.6     False
     3.613281e-03 -3.700000e+00 41.820651     84    -1.137222   1.6     False
     3.662109e-03 -3.750000e+00 40.673660     84    -1.163653   1.6     False
     3.710937e-03 -3.800000e+00 39.737632     84    -1.190085   1.8     False
     3.759766e-03 -3.850000e+00 38.096365     84    -1.216517   1.8     False
     3.808594e-03 -3.900000e+00 39.542126     84    -1.242949   1.8     False
     3.857422e-03 -3.950000e+00 38.049217     84    -1.269380   1.8     False
     3.906250e-03 -4.000000e+00 37.755899     85    -1.095812   1.8     False
     3.955078e-03 -4.050000e+00 37.923136     85    -1.122244   1.8     False
     4.003906e-03 -4.100000e+00 38.727630     85    -1.148675   1.8     False
     4.052734e-03 -4.150000e+00 38.923136     85    -1.175107   1.8     False
     4.101562e-03 -4.200000e+00 38.644611     85    -1.201539   1.8     False
     4.150391e-03 -4.250000e+00 37.644611     85    -1.227971   1.8     False
     4.199219e-03 -4.300000e+00 38.012734     84    -1.454402   1.8     False
     4.248047e-03 -4.350000e+00 36.159136     85    -1.280834   2.0     False
     4.296875e-03 -4.400000e+00 35.629155     85    -1.307266   2.0     False
     4.345703e-03 -4.450000e+00 36.138889     85    -1.333698   1.8     False
     4.394531e-03 -4.500000e+00 35.354642     85    -1.360129   1.8     False
     4.443359e-03 -4.550000e+00 35.759909     86    -1.186561   1.8     False
     4.492187e-03 -4.600000e+00 35.887433     86    -1.212993   1.8     False
     4.541016e-03 -4.650000e+00 35.588661     86    -1.239424   1.8     False
     4.589844e-03 -4.700000e+00 35.265632     86    -1.265856   1.8     False
     4.638672e-03 -4.750000e+00 34.461138     86    -1.292288   2.0     False
     4.687500e-03 -4.800000e+00 34.062692     86    -1.318720   2.0     False
     4.736328e-03 -4.850000e+00 33.461138     86    -1.345151   2.0     False
     4.785156e-03 -4.900000e+00 32.987108     86    -1.371583   2.0     False
     4.833984e-03 -4.950000e+00 33.397166     86    -1.398015   2.0     False
        slope  intercept    maxval  index  d_bestguess  fwhm  multimax
    -0.000049       0.05 83.453103     77    -0.554842   0.8     False
    Keeping 111 out of 111, skippin 0 because of null values in columns d_rot_tmp
    median: -0.508221
    75.000000 percentile cut: max residual for cut: 0.212142
    median: -0.521543
    i:00 mean:-0.521543(0.011637) stdev:0.105378(0.008179) X2norm:0.99 Nchanged:0 Ngood:83 Nclip:28

    mean: -0.516699
    i:01 mean:-0.516699(0.013966) stdev:0.137553(0.009825) X2norm:1.00 Nchanged:15 Ngood:98 Nclip:13

    mean: -0.503101
    i:02 mean:-0.503101(0.015620) stdev:0.158524(0.010992) X2norm:1.00 Nchanged:6 Ngood:104 Nclip:7

    mean: -0.499302
    i:03 mean:-0.499302(0.016663) stdev:0.171553(0.011727) X2norm:1.00 Nchanged:3 Ngood:107 Nclip:4

    mean: -0.494796
    i:04 mean:-0.494796(0.017117) stdev:0.177056(0.012047) X2norm:1.00 Nchanged:1 Ngood:108 Nclip:3

    mean: -0.490056
    i:05 mean:-0.490056(0.017614) stdev:0.183049(0.012398) X2norm:1.00 Nchanged:1 Ngood:109 Nclip:2

    mean: -0.490056
    i:06 mean:-0.490056(0.017614) stdev:0.183049(0.012398) X2norm:1.00 Nchanged:0 Ngood:109 Nclip:2
            slope     intercept    maxval  index  d_bestguess  fwhm  multimax
    -4.882812e-03  5.000000e+00 22.513200     17     2.248719   1.4     False
    -4.833984e-03  4.950000e+00 23.453239     17     2.247211   1.4     False
    -4.785156e-03  4.900000e+00 21.884746     17     2.245704   1.6     False
    -4.736328e-03  4.850000e+00 21.713498     17     2.244196   1.6     False
    -4.687500e-03  4.800000e+00 21.567169      6     0.042689   1.2     False
    -4.638672e-03  4.750000e+00 22.244140      6     0.041181   1.2     False
    -4.589844e-03  4.700000e+00 23.051983     16     2.039674   1.4     False
    -4.541016e-03  4.650000e+00 22.777470     16     2.038167   1.4     False
    -4.492188e-03  4.600000e+00 23.414726     16     2.036659   1.4     False
    -4.443359e-03  4.550000e+00 23.570518     16     2.035152   1.4     False
    -4.394531e-03  4.500000e+00 22.945369      6     0.033644   1.8     False
    -4.345703e-03  4.450000e+00 22.945369      6     0.032137   1.8     False
    -4.296875e-03  4.400000e+00 23.115955     15     1.830630   2.2     False
    -4.248047e-03  4.350000e+00 23.438984     15     1.829122   3.2     False
    -4.199219e-03  4.300000e+00 23.439646      6     0.027615   1.0     False
    -4.150391e-03  4.250000e+00 23.581963     15     1.826107   2.0     False
    -4.101563e-03  4.200000e+00 24.243478     15     1.824600   1.6     False
    -4.052734e-03  4.150000e+00 24.412083     15     1.823093   1.6     False
    -4.003906e-03  4.100000e+00 24.917806     15     1.821585   1.4     False
    -3.955078e-03  4.050000e+00 24.944707     14     1.620078   3.0     False
    -3.906250e-03  4.000000e+00 24.581963     14     1.618570   1.4     False
    -3.857422e-03  3.950000e+00 24.399270     14     1.617063   1.4     False
    -3.808594e-03  3.900000e+00 25.207775     14     1.615556   3.0     False
    -3.759766e-03  3.850000e+00 25.120746     14     1.614048   3.0     False
    -3.710938e-03  3.800000e+00 26.399270     14     1.612541   2.8     False
    -3.662109e-03  3.750000e+00 26.491090     14     1.611033   2.8     False
    -3.613281e-03  3.700000e+00 25.408072     14     1.609526   2.8     False
    -3.564453e-03  3.650000e+00 25.714699     13     1.408019   2.8     False
    -3.515625e-03  3.600000e+00 25.543450     13     1.406511   2.8     False
    -3.466797e-03  3.550000e+00 26.551051     13     1.405004   2.8     False
    -3.417969e-03  3.500000e+00 27.829576     13     1.403496   2.6     False
    -3.369141e-03  3.450000e+00 28.673784     13     1.401989   2.6     False
    -3.320313e-03  3.400000e+00 27.069587     13     1.400482   2.6     False
    -3.271484e-03  3.350000e+00 27.212566     13     1.398974   2.6     False
    -3.222656e-03  3.300000e+00 27.005615     13     1.397467   2.6     False
    -3.173828e-03  3.250000e+00 27.451376     13     1.395959   2.6     False
    -3.125000e-03  3.200000e+00 28.010827     12     1.194452   2.6     False
    -3.076172e-03  3.150000e+00 30.265093     12     1.192944   2.4     False
    -3.027344e-03  3.100000e+00 29.588122     12     1.191437   2.4     False
    -2.978516e-03  3.050000e+00 30.735113     12     1.189930   2.4     False
    -2.929688e-03  3.000000e+00 29.377160     12     1.188422   2.4     False
    -2.880859e-03  2.950000e+00 30.078389     12     1.186915   2.4     False
    -2.832031e-03  2.900000e+00 29.621015     11     0.985407   2.4     False
    -2.783203e-03  2.850000e+00 30.899540     11     0.983900   2.2     False
    -2.734375e-03  2.800000e+00 31.971113     11     0.982393   2.2     False
    -2.685547e-03  2.750000e+00 32.946855     11     0.980885   2.2     False
    -2.636719e-03  2.700000e+00 32.621182     11     0.979378   2.2     False
    -2.587891e-03  2.650000e+00 31.995371     11     0.974772   2.2     False
    -2.539063e-03  2.600000e+00 31.821313     10     0.769791   2.2     False
    -2.490234e-03  2.550000e+00 32.485637     11     0.964810   2.2     False
    -2.441406e-03  2.500000e+00 34.271085     10     0.759830   2.0     False
    -2.392578e-03  2.450000e+00 34.896897     10     0.754849   2.0     False
    -2.343750e-03  2.400000e+00 35.338647     10     0.749869   2.0     False
    -2.294922e-03  2.350000e+00 36.461379     10     0.744888   2.0     False
    -2.246094e-03  2.300000e+00 36.820112     10     0.739908   2.0     False
    -2.197266e-03  2.250000e+00 37.098636     10     0.734927   2.0     False
    -2.148438e-03  2.200000e+00 35.975904     10     0.729946   2.0     False
    -2.099609e-03  2.150000e+00 38.268442      9     0.524966   1.8     False
    -2.050781e-03  2.100000e+00 39.279887      9     0.519985   1.8     False
    -2.001953e-03  2.050000e+00 39.614361      9     0.515005   1.8     False
    -1.953125e-03  2.000000e+00 40.881441      9     0.510024   1.8     False
    -1.904297e-03  1.950000e+00 40.905699      9     0.505043   1.8     False
    -1.855469e-03  1.900000e+00 40.304145      9     0.500063   1.8     False
    -1.806641e-03  1.850000e+00 40.786977      9     0.495082   1.8     False
    -1.757813e-03  1.800000e+00 41.619740      9     0.490102   1.6     False
    -1.708984e-03  1.750000e+00 42.608295      9     0.485121   1.6     False
    -1.660156e-03  1.700000e+00 42.867725      8     0.280140   1.6     False
    -1.611328e-03  1.650000e+00 44.691685      8     0.275160   1.6     False
    -1.562500e-03  1.600000e+00 47.141458      8     0.270179   1.4     False
    -1.513672e-03  1.550000e+00 47.815785      8     0.265199   1.4     False
    -1.464844e-03  1.500000e+00 48.261547      8     0.260218   1.4     False
    -1.416016e-03  1.450000e+00 50.021536      8     0.255237   1.2     False
    -1.367188e-03  1.400000e+00 50.398064      7     0.050257   1.2     False
    -1.318359e-03  1.350000e+00 50.625262      7     0.045276   1.4     False
    -1.269531e-03  1.300000e+00 52.760807      7     0.040296   1.2     False
    -1.220703e-03  1.250000e+00 52.967759      7     0.035315   1.4     False
    -1.171875e-03  1.200000e+00 54.281986      7     0.030334   1.4     False
    -1.123047e-03  1.150000e+00 57.041975      7     0.025354   1.2     False
    -1.074219e-03  1.100000e+00 61.120202      7     0.020373   1.0     False
    -1.025391e-03  1.050000e+00 60.885929      6    -0.184607   1.0     False
    -9.765625e-04  1.000000e+00 63.215612      6    -0.189588   1.0     False
    -9.277344e-04  9.500000e-01 63.044364      6    -0.194569   1.2     False
    -8.789063e-04  9.000000e-01 64.227057      6    -0.199549   1.2     False
    -8.300781e-04  8.500000e-01 68.432807      6    -0.204530   1.2     False
    -7.812500e-04  8.000000e-01 70.348588      6    -0.209510   1.0     False
    -7.324219e-04  7.500000e-01 71.157093      6    -0.214491   1.0     False
    -6.835938e-04  7.000000e-01 71.420161      6    -0.219472   1.0     False
    -6.347656e-04  6.500000e-01 71.551695      6    -0.224452   1.0     False
    -5.859375e-04  6.000000e-01 72.360200      6    -0.229433   1.0     False
    -5.371094e-04  5.500000e-01 72.384458      6    -0.234413   1.0     False
    -4.882813e-04  5.000000e-01 75.466696      5    -0.439394   1.0     False
    -4.394531e-04  4.500000e-01 76.199784      5    -0.444375   1.0     False
    -3.906250e-04  4.000000e-01 78.418347      5    -0.449355   1.0     False
    -3.417969e-04  3.500000e-01 79.903823      5    -0.459139   0.8     False
    -2.929688e-04  3.000000e-01 80.035357      5    -0.472838   0.8     False
    -2.441406e-04  2.500000e-01 80.505376      5    -0.486538   0.8     False
    -1.953125e-04  2.000000e-01 82.667822      5    -0.516791   0.8     False
    -1.464844e-04  1.500000e-01 81.778943      5    -0.565317   0.8     False
    -9.765625e-05  1.000000e-01 79.110774      5    -0.613842   1.0     False
    -4.882813e-05  5.000000e-02 78.724973      6    -0.462368   1.0     False
    -1.734723e-17  1.776357e-14 80.680468      6    -0.510894   0.8     False
     4.882812e-05 -5.000000e-02 81.225905      6    -0.559419   0.8     False
     9.765625e-05 -1.000000e-01 82.818657      6    -0.607945   0.8     False
     1.464844e-04 -1.500000e-01 80.596249      6    -0.656471   0.8     False
     1.953125e-04 -2.000000e-01 78.221894      6    -0.704996   0.8     False
     2.441406e-04 -2.500000e-01 73.558516      6    -0.753522   1.0     False
     2.929687e-04 -3.000000e-01 75.677658      7    -0.602048   1.0     False
     3.417969e-04 -3.500000e-01 73.985232      7    -0.650574   1.0     False
     3.906250e-04 -4.000000e-01 72.646746      7    -0.699099   1.0     False
     4.394531e-04 -4.500000e-01 72.515212      7    -0.747625   0.8     False
     4.882812e-04 -5.000000e-01 70.221232      7    -0.796151   1.0     False
     5.371094e-04 -5.500000e-01 68.604222      7    -0.844676   1.0     False
     5.859375e-04 -6.000000e-01 65.616868      7    -0.893202   1.0     False
     6.347656e-04 -6.500000e-01 62.159662      7    -0.941728   1.0     False
     6.835937e-04 -7.000000e-01 61.382849      8    -0.790253   1.0     False
     7.324219e-04 -7.500000e-01 62.287185      8    -0.838779   1.0     False
     7.812500e-04 -8.000000e-01 61.781462      8    -0.887305   1.2     False
     8.300781e-04 -8.500000e-01 58.419920      8    -0.935830   1.2     False
     8.789062e-04 -9.000000e-01 54.815723      8    -0.984356   1.2     False
     9.277344e-04 -9.500000e-01 54.372605      8    -1.032882   1.2     False
     9.765625e-04 -1.000000e+00 52.839035      8    -1.081407   1.4     False
     1.025391e-03 -1.050000e+00 50.735769      8    -1.129933   1.4     False
     1.074219e-03 -1.100000e+00 48.755236      8    -1.178459   1.4     False
     1.123047e-03 -1.150000e+00 46.575186      8    -1.226984   1.6     False
     1.171875e-03 -1.200000e+00 47.704857      9    -1.075510   1.4     False
     1.220703e-03 -1.250000e+00 47.724324      9    -1.124036   1.4     False
     1.269531e-03 -1.300000e+00 45.692632      9    -1.172561   1.4     False
     1.318359e-03 -1.350000e+00 43.525395      9    -1.221087   1.4     False
     1.367187e-03 -1.400000e+00 42.576554      9    -1.269613   1.6     False
     1.416016e-03 -1.450000e+00 43.327741      9    -1.318138   1.6     False
     1.464844e-03 -1.500000e+00 42.136246      9    -1.366664   1.6     False
     1.513672e-03 -1.550000e+00 40.341996      9    -1.415190   1.6     False
     1.562500e-03 -1.600000e+00 40.007522      9    -1.463716   1.8     False
     1.611328e-03 -1.650000e+00 38.771521      9    -1.512241   1.8     False
     1.660156e-03 -1.700000e+00 39.655443      9    -1.560767   1.8     False
     1.708984e-03 -1.750000e+00 38.424234      9    -1.609293   1.8     False
     1.757812e-03 -1.800000e+00 36.798423      9    -1.657818   1.8     False
     1.806641e-03 -1.850000e+00 35.564403     10    -1.506344   2.0     False
     1.855469e-03 -1.900000e+00 36.145710     10    -1.554870   1.8     False
     1.904297e-03 -1.950000e+00 35.807225     10    -1.603395   1.8     False
     1.953125e-03 -2.000000e+00 36.076947     10    -1.651921   1.8     False
     2.001953e-03 -2.050000e+00 35.714203     10    -1.700447   2.0     False
     2.050781e-03 -2.100000e+00 34.905699     10    -1.748972   2.0     False
     2.099609e-03 -2.150000e+00 34.931399     10    -1.797498   2.0     False
     2.148437e-03 -2.200000e+00 35.332655     10    -1.846024   2.0     False
     2.197266e-03 -2.250000e+00 33.544397     10    -1.894549   2.2     False
     2.246094e-03 -2.300000e+00 32.727091     10    -1.943075   2.2     False
     2.294922e-03 -2.350000e+00 31.642630     11    -1.791601   2.2     False
     2.343750e-03 -2.400000e+00 31.908342     11    -1.840126   2.2     False
     2.392578e-03 -2.450000e+00 31.027063     11    -1.888652   2.2     False
     2.441406e-03 -2.500000e+00 31.138350     11    -1.937178   2.2     False
     2.490234e-03 -2.550000e+00 30.668330     11    -1.985703   2.2     False
     2.539062e-03 -2.600000e+00 31.452577     11    -2.034229   2.2     False
     2.587891e-03 -2.650000e+00 30.428319     11    -2.082755   2.2     False
     2.636719e-03 -2.700000e+00 31.575309     11    -2.131280   2.4     False
     2.685547e-03 -2.750000e+00 30.731102     11    -2.179806   2.4     False
     2.734375e-03 -2.800000e+00 28.982558     12    -2.028332   2.4     False
     2.783203e-03 -2.850000e+00 29.321043     12    -2.076858   2.4     False
     2.832031e-03 -2.900000e+00 28.986569     12    -2.125383   2.6     False
     2.880859e-03 -2.950000e+00 27.046530     12    -2.173909   2.6     False
     2.929687e-03 -3.000000e+00 27.855035     12    -2.222435   2.6     False
     2.978516e-03 -3.050000e+00 27.747759     12    -2.270960   2.8     False
     3.027344e-03 -3.100000e+00 28.385015     12    -2.319486   2.6     False
     3.076172e-03 -3.150000e+00 28.169262     12    -2.368012   2.6     False
     3.125000e-03 -3.200000e+00 28.953509     12    -2.416537   1.4     False
     3.173828e-03 -3.250000e+00 26.921229     12    -2.465063   2.6     False
     3.222656e-03 -3.300000e+00 27.329065     13    -2.313589   2.6     False
     3.271484e-03 -3.350000e+00 26.687797     13    -2.362114   2.8     False
     3.320312e-03 -3.400000e+00 26.349312     13    -2.410640   1.6     False
     3.369141e-03 -3.450000e+00 26.364768     13    -2.459166   1.6     False
     3.417969e-03 -3.500000e+00 25.233234     13    -2.507691   3.0     False
     3.466797e-03 -3.550000e+00 25.714699     13    -2.556217   1.6     False
     3.515625e-03 -3.600000e+00 25.690441     13    -2.604743   1.6     False
     3.564453e-03 -3.650000e+00 24.701886     13    -2.653268   1.8     False
     3.613281e-03 -3.700000e+00 24.209143     14    -2.501794   1.8     False
     3.662109e-03 -3.750000e+00 25.451797     14    -2.550320   1.6     False
     3.710937e-03 -3.800000e+00 25.247489     14    -2.598845   1.6     False
     3.759766e-03 -3.850000e+00 25.076241     14    -2.647371   1.6     False
     3.808594e-03 -3.900000e+00 23.993223     14    -2.695897   1.6     False
     3.857422e-03 -3.950000e+00 24.367411     14    -2.744422   1.6     False
     3.906250e-03 -4.000000e+00 23.558906     14    -2.792948   1.6     False
     3.955078e-03 -4.050000e+00 24.670194     14    -2.841474   1.6     False
     4.003906e-03 -4.100000e+00 24.175916     14    -2.890000   1.6     False
     4.052734e-03 -4.150000e+00 23.331708     14    -2.938525   1.6     False
     4.101562e-03 -4.200000e+00 23.538659     14    -2.987051   1.6     False
     4.150391e-03 -4.250000e+00 23.614243     15    -2.835577   1.8     False
     4.199219e-03 -4.300000e+00 23.928471     15    -2.884102   1.8     False
     4.248047e-03 -4.350000e+00 23.227242     15    -2.932628   1.8     False
     4.296875e-03 -4.400000e+00 22.960163     15    -2.981154   1.6     False
     4.345703e-03 -4.450000e+00 22.935905     15    -3.029679   1.6     False
     4.394531e-03 -4.500000e+00 22.768668     15    -3.078205   1.6     False
     4.443359e-03 -4.550000e+00 22.322906     15    -3.126731   1.6     False
     4.492187e-03 -4.600000e+00 22.454440     15    -3.175256   1.6     False
     4.541016e-03 -4.650000e+00 22.131411     15    -3.223782   1.8     False
     4.589844e-03 -4.700000e+00 22.458451     15    -3.272308   1.6     False
     4.638672e-03 -4.750000e+00 22.385677     16    -3.120833   1.6     False
     4.687500e-03 -4.800000e+00 23.194182     16    -3.169359   1.4     False
     4.736328e-03 -4.850000e+00 22.688460     16    -3.217885   1.8     False
     4.785156e-03 -4.900000e+00 22.099719     16    -3.266410   1.8     False
     4.833984e-03 -4.950000e+00 21.629699     16    -3.314936   1.8     False
       slope  intercept    maxval  index  d_bestguess  fwhm  multimax
    0.000098       -0.1 82.818657      6    -0.607945   0.8     False
    Keeping 107 out of 107, skippin 0 because of null values in columns d_rot_tmp
    median: -0.603414
    75.000000 percentile cut: max residual for cut: 0.199393
    median: -0.606744
    i:00 mean:-0.606744(0.011448) stdev:0.101749(0.008044) X2norm:0.99 Nchanged:0 Ngood:80 Nclip:27

    mean: -0.604056
    i:01 mean:-0.604056(0.014041) stdev:0.137578(0.009877) X2norm:1.00 Nchanged:17 Ngood:97 Nclip:10

    mean: -0.607249
    i:02 mean:-0.607249(0.015275) stdev:0.153516(0.010748) X2norm:1.00 Nchanged:5 Ngood:102 Nclip:5

    mean: -0.607249
    i:03 mean:-0.607249(0.015275) stdev:0.153516(0.010748) X2norm:1.00 Nchanged:0 Ngood:102 Nclip:5

    0



.. GENERATED FROM PYTHON SOURCE LINES 147-152

**Check the Output**

The reference image has not changed, but let's read in the newly
aligned image and compare with the original. 
subsequent correction needed for optimal alignment.

.. GENERATED FROM PYTHON SOURCE LINES 152-176

.. code-block:: default


    aligned_image = os.path.join('mastDownload',os.path.basename(align_image).replace('.fits','.jhat.fits'))
    aligned_fits = fits.open(aligned_image)
    aligned_data = fits.open(aligned_image)['SCI',1].data
    aligned_y,aligned_x = skycoord_to_pixel(star_location,wcs.WCS(aligned_fits['SCI',1],aligned_fits))
    aligned_cutout = extract_array(aligned_data,(11,11),(aligned_x,aligned_y))

    norm3 = simple_norm(aligned_cutout,stretch='linear',min_cut=-.5,max_cut=3)
    fig,axes = plt.subplots(1,3)
    axes[0].imshow(ref_cutout, origin='lower',
                          norm=norm1,cmap='gray')
    axes[1].imshow(align_cutout, origin='lower',
                          norm=norm2,cmap='gray')
    axes[2].imshow(aligned_cutout, origin='lower',
                          norm=norm3,cmap='gray')
    axes[0].set_title('Reference')
    axes[1].set_title('To Align')
    axes[2].set_title('Aligned')
    for i in range(3):
    	axes[i].tick_params(labelcolor='none',axis='both',color='none')


    plt.show()




.. image-sg:: /examples/images/sphx_glr_plot_b_nircam_008.png
   :alt: Reference, To Align, Aligned
   :srcset: /examples/images/sphx_glr_plot_b_nircam_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(




.. GENERATED FROM PYTHON SOURCE LINES 177-184

----------------
Align to Catalog
----------------

You can also align each image to the Gaia DR3 catalog, or you
could replace the catalog created in step one with your own
catalog of the field. 

.. GENERATED FROM PYTHON SOURCE LINES 185-220

.. code-block:: default



    wcs_align.run_all(align_image,
    		  telescope='jwst',
    		  outsubdir='mastDownload',
              overwrite=True,
              d2d_max=.5,
              showplots=0,
              refcatname='Gaia',
              histocut_order='dxdy',
                  sharpness_lim=(0.3,0.9),
                  roundness1_lim=(-0.7, 0.7),
                  SNR_min= 3,
                  dmag_max=1.0,
                  objmag_lim =(14,24))

    aligned_image = os.path.join('mastDownload',os.path.basename(align_image).replace('.fits','.jhat.fits'))
    aligned_fits = fits.open(aligned_image)
    aligned_data = fits.open(aligned_image)['SCI',1].data
    aligned_y,aligned_x = skycoord_to_pixel(star_location,wcs.WCS(aligned_fits['SCI',1],aligned_fits))
    aligned_cutout = extract_array(aligned_data,(11,11),(aligned_x,aligned_y))

    norm3 = simple_norm(aligned_cutout,stretch='linear',min_cut=-.5,max_cut=3)
    fig,axes = plt.subplots(1,2)
    axes[0].imshow(align_cutout, origin='lower',
                          norm=norm2,cmap='gray')
    axes[1].imshow(aligned_cutout, origin='lower',
                          norm=norm3,cmap='gray')
    axes[0].set_title('To Align')
    axes[1].set_title('Aligned')
    for i in range(2):
    	axes[i].tick_params(labelcolor='none',axis='both',color='none')


    plt.show()



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_009.png
         :alt: pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction, pre WCS correction
         :srcset: /examples/images/sphx_glr_plot_b_nircam_009.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_010.png
         :alt: after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction, after WCS correction
         :srcset: /examples/images/sphx_glr_plot_b_nircam_010.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /examples/images/sphx_glr_plot_b_nircam_011.png
         :alt: To Align, Aligned
         :srcset: /examples/images/sphx_glr_plot_b_nircam_011.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'datfix' made the change 'Set DATE-BEG to '2022-07-06T19:16:42.721' from MJD-BEG.
    Set DATE-AVG to '2022-07-06T19:17:14.932' from MJD-AVG.
    Set DATE-END to '2022-07-06T19:17:47.142' from MJD-END'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/stats/sigma_clipping.py:411: AstropyUserWarning: Input data contains invalid values (NaNs or infs), which were automatically clipped.
      warnings.warn('Input data contains invalid values (NaNs or '
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/stats/sigma_clipping.py:411: AstropyUserWarning: Input data contains invalid values (NaNs or infs), which were automatically clipped.
      warnings.warn('Input data contains invalid values (NaNs or '
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/units/function/logarithmic.py:47: RuntimeWarning: invalid value encountered in log10
      return dex.to(self._function_unit, np.log10(x))
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/jhat/simple_jwst_phot.py:898: RuntimeWarning: invalid value encountered in log10
      phot['magerr'] = 2.5 * np.log10(1.0 + (fluxerr/flux))
    INFO: Query finished. [astroquery.utils.tap.core]
    Number of stars: 21
    ### NO propoer motion correction!!!
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/pandas/core/arraylike.py:402: RuntimeWarning: invalid value encountered in sqrt
      result = getattr(ufunc, method)(*inputs, **kwargs)
    Number of stars after removing nan's: 21
            slope     intercept   maxval  index  d_bestguess  fwhm  multimax
    -4.882812e-03  5.000000e+00 3.323029      9    -4.266164   0.8     False
    -4.833984e-03  4.950000e+00 3.323029      9    -4.259090   0.8     False
    -4.785156e-03  4.900000e+00 2.984544      9    -4.252016   1.0     False
    -4.736328e-03  4.850000e+00 2.661515     40     1.955057   0.8     False
    -4.687500e-03  4.800000e+00 2.661515     40     1.962131   0.8     False
    -4.638672e-03  4.750000e+00 2.661515     40     1.969205   0.8     False
    -4.589844e-03  4.700000e+00 3.000000     40     1.976279   0.8     False
    -4.541016e-03  4.650000e+00 2.661515     40     1.983353   0.8     False
    -4.492188e-03  4.600000e+00 2.661515     40     1.990427   0.8     False
    -4.443359e-03  4.550000e+00 2.661515     40     1.997501   0.8     False
    -4.394531e-03  4.500000e+00 2.661515     40     2.004575   0.8     False
    -4.345703e-03  4.450000e+00 2.661515     40     2.011649   0.8     False
    -4.296875e-03  4.400000e+00 2.661515     40     2.018723   0.8     False
    -4.248047e-03  4.350000e+00 2.661515     39     1.825797   0.8     False
    -4.199219e-03  4.300000e+00 2.661515     39     1.832871   0.8     False
    -4.150391e-03  4.250000e+00 2.661515     39     1.839945   0.8     False
    -4.101563e-03  4.200000e+00 2.661515     39     1.847019   0.8     False
    -4.052734e-03  4.150000e+00 3.000000     39     1.854092   0.8     False
    -4.003906e-03  4.100000e+00 2.661515     39     1.861166   0.8     False
    -3.955078e-03  4.050000e+00 2.661515     39     1.868240   0.8     False
    -3.906250e-03  4.000000e+00 2.661515     39     1.875314   0.8     False
    -3.857422e-03  3.950000e+00 2.661515     39     1.882388   0.8     False
    -3.808594e-03  3.900000e+00 2.661515     39     1.889462   0.8     False
    -3.759766e-03  3.850000e+00 2.661515     39     1.896536   0.8     False
    -3.710938e-03  3.800000e+00 2.661515     38     1.703610   0.8     False
    -3.662109e-03  3.750000e+00 2.661515     38     1.710684   0.8     False
    -3.613281e-03  3.700000e+00 2.661515     38     1.717758   0.8     False
    -3.564453e-03  3.650000e+00 2.661515     38     1.724832   0.8     False
    -3.515625e-03  3.600000e+00 3.000000     38     1.731906   0.8     False
    -3.466797e-03  3.550000e+00 2.661515     38     1.738980   0.8     False
    -3.417969e-03  3.500000e+00 2.661515     38     1.746054   0.8     False
    -3.369141e-03  3.450000e+00 2.661515     38     1.753128   0.8     False
    -3.320313e-03  3.400000e+00 2.661515     38     1.760201   0.8     False
    -3.271484e-03  3.350000e+00 2.661515     38     1.767275   0.8     False
    -3.222656e-03  3.300000e+00 2.661515     38     1.774349   0.8     False
    -3.173828e-03  3.250000e+00 2.661515     37     1.581423   0.8     False
    -3.125000e-03  3.200000e+00 2.661515     37     1.588497   0.8     False
    -3.076172e-03  3.150000e+00 2.661515     37     1.595571   0.8     False
    -3.027344e-03  3.100000e+00 3.000000     37     1.602645   0.8     False
    -2.978516e-03  3.050000e+00 3.000000     37     1.609719   0.8     False
    -2.929688e-03  3.000000e+00 2.661515     37     1.616793   0.8     False
    -2.880859e-03  2.950000e+00 2.661515     37     1.623867   0.8     False
    -2.832031e-03  2.900000e+00 2.661515     37     1.630941   0.8     False
    -2.783203e-03  2.850000e+00 2.661515     37     1.638015   0.8     False
    -2.734375e-03  2.800000e+00 2.661515     37     1.645089   0.8     False
    -2.685547e-03  2.750000e+00 2.661515     37     1.652163   0.8     False
    -2.636719e-03  2.700000e+00 2.661515     36     1.459236   0.8     False
    -2.587891e-03  2.650000e+00 2.661515     36     1.466310   0.8     False
    -2.539063e-03  2.600000e+00 2.661515     36     1.473384   0.8     False
    -2.490234e-03  2.550000e+00 3.000000     36     1.480458   0.8     False
    -2.441406e-03  2.500000e+00 3.000000     36     1.487532   0.8     False
    -2.392578e-03  2.450000e+00 3.000000     36     1.494606   0.8     False
    -2.343750e-03  2.400000e+00 2.661515     36     1.501680   0.8     False
    -2.294922e-03  2.350000e+00 2.661515     36     1.508754   0.8     False
    -2.246094e-03  2.300000e+00 2.661515     36     1.515828   0.8     False
    -2.197266e-03  2.250000e+00 2.661515     36     1.522902   0.8     False
    -2.148438e-03  2.200000e+00 2.661515     36     1.529976   0.8     False
    -2.099609e-03  2.150000e+00 2.661515     35     1.337050   0.8     False
    -2.050781e-03  2.100000e+00 2.661515     35     1.336205   0.8     False
    -2.001953e-03  2.050000e+00 2.661515     35     1.325536   0.8     False
    -1.953125e-03  2.000000e+00 2.661515     35     1.314866   0.8     False
    -1.904297e-03  1.950000e+00 2.661515     35     1.304197   0.8     False
    -1.855469e-03  1.900000e+00 2.661515     35     1.293527   0.8     False
    -1.806641e-03  1.850000e+00 2.661515     35     1.282858   0.8     False
    -1.757813e-03  1.800000e+00 2.661515     35     1.272188   0.8     False
    -1.708984e-03  1.750000e+00 2.661515     35     1.261519   0.8     False
    -1.660156e-03  1.700000e+00 2.661515     35     1.250849   0.8     False
    -1.611328e-03  1.650000e+00 2.661515     35     1.240180   0.8     False
    -1.562500e-03  1.600000e+00 2.661515     35     1.229510   0.8     False
    -1.513672e-03  1.550000e+00 2.661515     35     1.218840   0.8     False
    -1.464844e-03  1.500000e+00 2.661515     35     1.208171   0.8     False
    -1.416016e-03  1.450000e+00 2.661515     35     1.197501   0.8     False
    -1.367188e-03  1.400000e+00 2.661515     35     1.186832   0.8     False
    -1.318359e-03  1.350000e+00 2.661515     35     1.176162   0.8     False
    -1.269531e-03  1.300000e+00 2.661515     35     1.165493   0.8     False
    -1.220703e-03  1.250000e+00 2.661515     35     1.154823   0.8     False
    -1.171875e-03  1.200000e+00 2.661515     35     1.144154   0.8     False
    -1.123047e-03  1.150000e+00 2.661515     35     1.133484   0.8     False
    -1.074219e-03  1.100000e+00 2.661515     35     1.122815   0.8     False
    -1.025391e-03  1.050000e+00 2.661515     35     1.112145   0.8     False
    -9.765625e-04  1.000000e+00 2.661515     35     1.101475   0.8     False
    -9.277344e-04  9.500000e-01 2.661515     35     1.090806   0.8     False
    -8.789063e-04  9.000000e-01 2.661515     35     1.080136   0.8     False
    -8.300781e-04  8.500000e-01 2.661515     35     1.069467   0.8     False
    -7.812500e-04  8.000000e-01 2.661515     35     1.058797   0.8     False
    -7.324219e-04  7.500000e-01 3.000000     35     1.048128   0.8     False
    -6.835938e-04  7.000000e-01 3.000000     35     1.037458   0.8     False
    -6.347656e-04  6.500000e-01 3.000000     35     1.026789   0.8     False
    -5.859375e-04  6.000000e-01 3.000000     35     1.016119   0.8     False
    -5.371094e-04  5.500000e-01 3.000000     35     1.005450   0.8     False
    -4.882813e-04  5.000000e-01 3.000000     35     0.994780   0.8     False
    -4.394531e-04  4.500000e-01 3.000000     35     0.984111   0.8     False
    -3.906250e-04  4.000000e-01 3.000000     35     0.973441   0.8     False
    -3.417969e-04  3.500000e-01 3.000000     35     0.962771   0.8     False
    -2.929688e-04  3.000000e-01 3.000000     35     0.952102   0.8     False
    -2.441406e-04  2.500000e-01 3.000000     35     0.941432   0.8     False
    -1.953125e-04  2.000000e-01 3.000000     35     0.930763   0.8     False
    -1.464844e-04  1.500000e-01 3.000000     35     0.920093   0.8     False
    -9.765625e-05  1.000000e-01 3.000000     35     0.909424   0.8     False
    -4.882813e-05  5.000000e-02 3.000000     35     0.898754   0.8     False
    -1.734723e-17  1.776357e-14 3.000000     35     0.888085   0.8     False
     4.882812e-05 -5.000000e-02 3.000000     35     0.877415   0.8     False
     9.765625e-05 -1.000000e-01 3.000000     35     0.866746   0.8     False
     1.464844e-04 -1.500000e-01 3.000000     35     0.856076   0.8     False
     1.953125e-04 -2.000000e-01 3.000000     35     0.845406   0.8     False
     2.441406e-04 -2.500000e-01 3.000000     35     0.834737   0.8     False
     2.929687e-04 -3.000000e-01 3.000000     35     0.824067   0.8     False
     3.417969e-04 -3.500000e-01 3.000000     35     0.813398   0.8     False
     3.906250e-04 -4.000000e-01 3.000000     35     0.802728   0.8     False
     4.394531e-04 -4.500000e-01 3.000000     35     0.792059   0.8     False
     4.882812e-04 -5.000000e-01 3.000000     35     0.781389   0.8     False
     5.371094e-04 -5.500000e-01 3.000000     35     0.770720   0.8     False
     5.859375e-04 -6.000000e-01 3.000000     35     0.760050   0.8     False
     6.347656e-04 -6.500000e-01 3.024258     35     0.749381   0.8     False
     6.835937e-04 -7.000000e-01 3.024258     35     0.738711   0.8     False
     7.324219e-04 -7.500000e-01 3.024258     35     0.728042   0.8     False
     7.812500e-04 -8.000000e-01 3.024258     35     0.717372   0.8     False
     8.300781e-04 -8.500000e-01 3.191495     35     0.706702   0.8     False
     8.789062e-04 -9.000000e-01 3.191495     35     0.696033   0.8     False
     9.277344e-04 -9.500000e-01 3.191495     35     0.685363   0.8     False
     9.765625e-04 -1.000000e+00 3.191495     35     0.674694   0.8     False
     1.025391e-03 -1.050000e+00 3.661515     35     0.664024   0.8     False
     1.074219e-03 -1.100000e+00 3.661515     35     0.653355   0.8     False
     1.123047e-03 -1.150000e+00 3.661515     35     0.642685   0.8     False
     1.171875e-03 -1.200000e+00 3.661515     35     0.632016   0.8     False
     1.220703e-03 -1.250000e+00 4.000000     35     0.621346   0.8     False
     1.269531e-03 -1.300000e+00 4.000000     35     0.610677   0.8     False
     1.318359e-03 -1.350000e+00 4.000000     35     0.600007   0.8     False
     1.367187e-03 -1.400000e+00 4.000000     35     0.589337   0.8     False
     1.416016e-03 -1.450000e+00 3.661515     35     0.578668   0.8     False
     1.464844e-03 -1.500000e+00 3.661515     35     0.567998   0.8     False
     1.513672e-03 -1.550000e+00 3.661515     35     0.557329   0.8     False
     1.562500e-03 -1.600000e+00 3.661515     35     0.546659   0.8     False
     1.611328e-03 -1.650000e+00 3.191495     35     0.535990   0.8     False
     1.660156e-03 -1.700000e+00 3.191495     35     0.525320   0.8     False
     1.708984e-03 -1.750000e+00 3.191495     35     0.514651   0.8     False
     1.757812e-03 -1.800000e+00 3.191495     35     0.503981   0.8     False
     1.806641e-03 -1.850000e+00 3.024258     35     0.493312   0.8     False
     1.855469e-03 -1.900000e+00 3.024258     35     0.482642   0.8     False
     1.904297e-03 -1.950000e+00 3.024258     35     0.471973   0.8     False
     1.953125e-03 -2.000000e+00 3.024258     35     0.461303   0.8     False
     2.001953e-03 -2.050000e+00 3.024258     35     0.450633   0.8     False
     2.050781e-03 -2.100000e+00 3.000000     35     0.439964   0.8     False
     2.099609e-03 -2.150000e+00 3.000000     35     0.429294   0.8     False
     2.148437e-03 -2.200000e+00 3.000000     35     0.418625   0.8     False
     2.197266e-03 -2.250000e+00 3.000000     35     0.407955   0.8     False
     2.246094e-03 -2.300000e+00 3.000000     35     0.397286   0.8     False
     2.294922e-03 -2.350000e+00 3.000000     35     0.386616   0.8     False
     2.343750e-03 -2.400000e+00 3.000000     35     0.375947   0.8     False
     2.392578e-03 -2.450000e+00 3.000000     35     0.365277   0.8     False
     2.441406e-03 -2.500000e+00 3.000000     35     0.354608   0.8     False
     2.490234e-03 -2.550000e+00 3.000000     35     0.343938   0.8     False
     2.539062e-03 -2.600000e+00 3.000000     35     0.333268   0.8     False
     2.587891e-03 -2.650000e+00 3.000000     35     0.322599   0.8     False
     2.636719e-03 -2.700000e+00 3.000000     35     0.311929   0.8     False
     2.685547e-03 -2.750000e+00 3.000000     35     0.301260   0.8     False
     2.734375e-03 -2.800000e+00 3.000000     35     0.290590   0.8     False
     2.783203e-03 -2.850000e+00 3.000000     35     0.279921   0.8     False
     2.832031e-03 -2.900000e+00 3.000000     35     0.269251   0.8     False
     2.880859e-03 -2.950000e+00 3.000000     35     0.258582   0.8     False
     2.929687e-03 -3.000000e+00 3.000000     35     0.247912   0.8     False
     2.978516e-03 -3.050000e+00 3.000000     35     0.237243   0.8     False
     3.027344e-03 -3.100000e+00 3.000000     35     0.226573   0.8     False
     3.076172e-03 -3.150000e+00 3.000000     35     0.215904   0.8     False
     3.125000e-03 -3.200000e+00 3.000000     35     0.205234   0.8     False
     3.173828e-03 -3.250000e+00 3.000000     35     0.194564   0.8     False
     3.222656e-03 -3.300000e+00 3.000000     35     0.183895   0.8     False
     3.271484e-03 -3.350000e+00 3.000000     35     0.173225   0.8     False
     3.320312e-03 -3.400000e+00 3.000000     35     0.162556   0.8     False
     3.369141e-03 -3.450000e+00 3.000000     35     0.151886   0.8     False
     3.417969e-03 -3.500000e+00 3.000000     35     0.141217   0.8     False
     3.466797e-03 -3.550000e+00 3.000000     35     0.130547   0.8     False
     3.515625e-03 -3.600000e+00 3.000000     35     0.119878   0.8     False
     3.564453e-03 -3.650000e+00 3.000000     35     0.109208   0.8     False
     3.613281e-03 -3.700000e+00 3.000000     35     0.098539   0.8     False
     3.662109e-03 -3.750000e+00 3.000000     35     0.087869   0.8     False
     3.710937e-03 -3.800000e+00 3.000000     35     0.077199   0.8     False
     3.759766e-03 -3.850000e+00 3.000000     35     0.066530   0.8     False
     3.808594e-03 -3.900000e+00 3.000000     35     0.055860   0.8     False
     3.857422e-03 -3.950000e+00 3.000000     35     0.045191   0.8     False
     3.906250e-03 -4.000000e+00 3.000000     35     0.034521   0.8     False
     3.955078e-03 -4.050000e+00 3.000000     35     0.023852   0.8     False
     4.003906e-03 -4.100000e+00 3.000000     35     0.013182   0.8     False
     4.052734e-03 -4.150000e+00 3.000000     35     0.002513   0.8     False
     4.101562e-03 -4.200000e+00 3.000000     35    -0.008157   0.8     False
     4.150391e-03 -4.250000e+00 3.000000     35    -0.018826   0.8     False
     4.199219e-03 -4.300000e+00 3.000000     35    -0.029496   0.8     False
     4.248047e-03 -4.350000e+00 3.000000     35    -0.040165   0.8     False
     4.296875e-03 -4.400000e+00 3.000000     35    -0.050835   0.8     False
     4.345703e-03 -4.450000e+00 3.000000     35    -0.061505   0.8     False
     4.394531e-03 -4.500000e+00 3.000000     35    -0.072174   0.8     False
     4.443359e-03 -4.550000e+00 3.000000     35    -0.082844   0.8     False
     4.492187e-03 -4.600000e+00 3.000000     35    -0.093513   0.8     False
     4.541016e-03 -4.650000e+00 3.000000     35    -0.104183   0.8     False
     4.589844e-03 -4.700000e+00 3.000000     35    -0.114852   0.8     False
     4.638672e-03 -4.750000e+00 3.000000     35    -0.125522   0.8     False
     4.687500e-03 -4.800000e+00 3.000000     35    -0.136191   0.8     False
     4.736328e-03 -4.850000e+00 3.000000     35    -0.146861   0.8     False
     4.785156e-03 -4.900000e+00 3.000000     35    -0.157530   0.8     False
     4.833984e-03 -4.950000e+00 3.000000     35    -0.168200   0.8     False
       slope  intercept  maxval  index  d_bestguess  fwhm  multimax
    0.001221      -1.25     4.0     35     0.621346   0.8     False
    Keeping 4 out of 4, skippin 0 because of null values in columns d_rot_tmp
    median: 0.640435
    75.000000 percentile cut: max residual for cut: 0.056049
    median: 0.679705
    i:00 mean:0.679705(0.044312) stdev:0.062666(0.025583) X2norm:0.79 Nchanged:0 Ngood:3 Nclip:1

    mean: 0.623836
    i:01 mean:0.623836(0.040472) stdev:0.070100(0.024784) X2norm:1.00 Nchanged:1 Ngood:4 Nclip:0

    mean: 0.623836
    i:02 mean:0.623836(0.040472) stdev:0.070100(0.024784) X2norm:1.00 Nchanged:0 Ngood:4 Nclip:0
            slope     intercept   maxval  index  d_bestguess  fwhm  multimax
    -4.882812e-03  5.000000e+00 2.323029      5    -5.210110   0.8     False
    -4.833984e-03  4.950000e+00 2.323029      5    -5.176109   0.8     False
    -4.785156e-03  4.900000e+00 2.661515      5    -5.142107   0.8     False
    -4.736328e-03  4.850000e+00 2.661515      5    -5.108106   0.8     False
    -4.687500e-03  4.800000e+00 2.661515      5    -5.074105   0.8     False
    -4.638672e-03  4.750000e+00 2.661515      5    -5.040103   0.8     False
    -4.589844e-03  4.700000e+00 2.661515      5    -5.006102   0.8     False
    -4.541016e-03  4.650000e+00 2.661515      5    -4.972101   0.8     False
    -4.492188e-03  4.600000e+00 2.661515      5    -4.938099   0.8     False
    -4.443359e-03  4.550000e+00 2.661515      5    -4.904098   0.8     False
    -4.394531e-03  4.500000e+00 2.661515      5    -4.870097   0.8     False
    -4.345703e-03  4.450000e+00 2.661515      5    -4.836096   0.8     False
    -4.296875e-03  4.400000e+00 2.661515      5    -4.802094   0.8     False
    -4.248047e-03  4.350000e+00 2.661515      5    -4.768093   0.8     False
    -4.199219e-03  4.300000e+00 2.661515      5    -4.734092   0.8     False
    -4.150391e-03  4.250000e+00 2.661515      5    -4.700090   0.8     False
    -4.101563e-03  4.200000e+00 2.661515      5    -4.666089   0.8     False
    -4.052734e-03  4.150000e+00 2.661515      5    -4.632088   0.8     False
    -4.003906e-03  4.100000e+00 2.661515      5    -4.598086   0.8     False
    -3.955078e-03  4.050000e+00 2.661515      5    -4.564085   0.8     False
    -3.906250e-03  4.000000e+00 2.661515      5    -4.530084   0.8     False
    -3.857422e-03  3.950000e+00 2.661515      5    -4.496082   0.8     False
    -3.808594e-03  3.900000e+00 2.661515      5    -4.462081   0.8     False
    -3.759766e-03  3.850000e+00 2.661515      5    -4.428080   0.8     False
    -3.710938e-03  3.800000e+00 2.661515      5    -4.394079   0.8     False
    -3.662109e-03  3.750000e+00 2.661515      5    -4.360077   0.8     False
    -3.613281e-03  3.700000e+00 2.661515      5    -4.326076   0.8     False
    -3.564453e-03  3.650000e+00 2.661515      5    -4.292075   0.8     False
    -3.515625e-03  3.600000e+00 2.661515      5    -4.258073   0.8     False
    -3.466797e-03  3.550000e+00 2.661515      5    -4.224072   0.8     False
    -3.417969e-03  3.500000e+00 2.661515      5    -4.190071   0.8     False
    -3.369141e-03  3.450000e+00 2.661515      5    -4.156069   0.8     False
    -3.320313e-03  3.400000e+00 2.661515      5    -4.122068   0.8     False
    -3.271484e-03  3.350000e+00 2.661515      5    -4.088067   0.8     False
    -3.222656e-03  3.300000e+00 2.661515      5    -4.054066   0.8     False
    -3.173828e-03  3.250000e+00 2.661515      5    -4.020064   0.8     False
    -3.125000e-03  3.200000e+00 2.661515      5    -3.986063   0.8     False
    -3.076172e-03  3.150000e+00 2.661515      5    -3.952062   0.8     False
    -3.027344e-03  3.100000e+00 2.661515      5    -3.918060   0.8     False
    -2.978516e-03  3.050000e+00 2.661515      5    -3.884059   0.8     False
    -2.929688e-03  3.000000e+00 2.661515      5    -3.850058   0.8     False
    -2.880859e-03  2.950000e+00 2.661515      5    -3.816056   0.8     False
    -2.832031e-03  2.900000e+00 2.661515      5    -3.782055   0.8     False
    -2.783203e-03  2.850000e+00 2.661515      5    -3.748054   0.8     False
    -2.734375e-03  2.800000e+00 2.661515      5    -3.714053   0.8     False
    -2.685547e-03  2.750000e+00 2.661515      5    -3.680051   0.8     False
    -2.636719e-03  2.700000e+00 2.661515      5    -3.646050   0.8     False
    -2.587891e-03  2.650000e+00 2.661515      5    -3.612049   0.8     False
    -2.539063e-03  2.600000e+00 2.661515      5    -3.578047   0.8     False
    -2.490234e-03  2.550000e+00 2.661515      5    -3.544046   0.8     False
    -2.441406e-03  2.500000e+00 2.661515      5    -3.510045   0.8     False
    -2.392578e-03  2.450000e+00 2.661515      5    -3.476043   0.8     False
    -2.343750e-03  2.400000e+00 2.661515      5    -3.442042   0.8     False
    -2.294922e-03  2.350000e+00 2.661515      5    -3.408041   0.8     False
    -2.246094e-03  2.300000e+00 2.661515      5    -3.374039   0.8     False
    -2.197266e-03  2.250000e+00 2.661515      5    -3.340038   0.8     False
    -2.148438e-03  2.200000e+00 2.661515      4    -3.506037   0.8     False
    -2.099609e-03  2.150000e+00 2.661515      4    -3.472036   0.8     False
    -2.050781e-03  2.100000e+00 2.661515      4    -3.438034   0.8     False
    -2.001953e-03  2.050000e+00 3.000000      4    -3.404033   0.8     False
    -1.953125e-03  2.000000e+00 3.000000      4    -3.370032   0.8     False
    -1.904297e-03  1.950000e+00 3.000000      4    -3.336030   0.8     False
    -1.855469e-03  1.900000e+00 3.000000      4    -3.302029   0.8     False
    -1.806641e-03  1.850000e+00 3.000000      4    -3.268028   0.8     False
    -1.757813e-03  1.800000e+00 3.000000      4    -3.234026   0.8     False
    -1.708984e-03  1.750000e+00 3.000000      4    -3.200025   0.8     False
    -1.660156e-03  1.700000e+00 3.000000      4    -3.166024   0.8     False
    -1.611328e-03  1.650000e+00 3.000000      4    -3.132023   0.8     False
    -1.562500e-03  1.600000e+00 3.000000      4    -3.098021   0.8     False
    -1.513672e-03  1.550000e+00 3.000000      4    -3.064020   0.8     False
    -1.464844e-03  1.500000e+00 3.000000      4    -3.030019   0.8     False
    -1.416016e-03  1.450000e+00 3.000000      4    -2.996017   0.8     False
    -1.367188e-03  1.400000e+00 3.000000      4    -2.962016   0.8     False
    -1.318359e-03  1.350000e+00 3.000000      4    -2.928015   0.8     False
    -1.269531e-03  1.300000e+00 3.000000      4    -2.894013   0.8     False
    -1.220703e-03  1.250000e+00 3.000000      4    -2.860012   0.8     False
    -1.171875e-03  1.200000e+00 3.000000      4    -2.826011   0.8     False
    -1.123047e-03  1.150000e+00 3.000000      4    -2.792010   0.8     False
    -1.074219e-03  1.100000e+00 3.000000      4    -2.758008   0.8     False
    -1.025391e-03  1.050000e+00 3.000000      4    -2.724007   0.8     False
    -9.765625e-04  1.000000e+00 3.000000      4    -2.690006   0.8     False
    -9.277344e-04  9.500000e-01 3.000000      4    -2.656004   0.8     False
    -8.789063e-04  9.000000e-01 3.000000      4    -2.622003   0.8     False
    -8.300781e-04  8.500000e-01 3.000000      4    -2.588002   0.8     False
    -7.812500e-04  8.000000e-01 3.000000      4    -2.554000   0.8     False
    -7.324219e-04  7.500000e-01 3.000000      4    -2.519999   0.8     False
    -6.835938e-04  7.000000e-01 3.000000      4    -2.485998   0.8     False
    -6.347656e-04  6.500000e-01 3.000000      4    -2.451996   0.8     False
    -5.859375e-04  6.000000e-01 3.000000      4    -2.417995   0.8     False
    -5.371094e-04  5.500000e-01 3.000000      4    -2.383994   0.8     False
    -4.882813e-04  5.000000e-01 3.000000      4    -2.349993   0.8     False
    -4.394531e-04  4.500000e-01 3.000000      4    -2.315991   0.8     False
    -3.906250e-04  4.000000e-01 3.000000      4    -2.281990   0.8     False
    -3.417969e-04  3.500000e-01 3.024258      4    -2.247989   0.8     False
    -2.929688e-04  3.000000e-01 3.024258      4    -2.213987   0.8     False
    -2.441406e-04  2.500000e-01 3.024258      4    -2.179986   0.8     False
    -1.953125e-04  2.000000e-01 3.024258      4    -2.145985   0.8     False
    -1.464844e-04  1.500000e-01 3.024258      4    -2.111983   0.8     False
    -9.765625e-05  1.000000e-01 3.024258      4    -2.077982   0.8     False
    -4.882813e-05  5.000000e-02 3.191495      4    -2.043981   0.8     False
    -1.734723e-17  1.776357e-14 3.191495      4    -2.009980   0.8     False
     4.882812e-05 -5.000000e-02 3.191495      4    -1.975978   0.8     False
     9.765625e-05 -1.000000e-01 3.191495      4    -1.941977   0.8     False
     1.464844e-04 -1.500000e-01 3.191495      4    -1.907976   0.8     False
     1.953125e-04 -2.000000e-01 3.191495      4    -1.873974   0.8     False
     2.441406e-04 -2.500000e-01 3.661515      4    -1.839973   0.8     False
     2.929687e-04 -3.000000e-01 3.661515      4    -1.805972   0.8     False
     3.417969e-04 -3.500000e-01 3.661515      4    -1.771970   0.8     False
     3.906250e-04 -4.000000e-01 3.661515      4    -1.737969   0.8     False
     4.394531e-04 -4.500000e-01 3.661515      4    -1.703968   0.8     False
     4.882812e-04 -5.000000e-01 3.661515      4    -1.672801   0.8     False
     5.371094e-04 -5.500000e-01 4.000000      4    -1.642504   0.8     False
     5.859375e-04 -6.000000e-01 4.000000      4    -1.612207   0.8     False
     6.347656e-04 -6.500000e-01 4.000000      4    -1.581910   0.8     False
     6.835937e-04 -7.000000e-01 4.000000      4    -1.551612   0.8     False
     7.324219e-04 -7.500000e-01 4.000000      4    -1.521315   0.8     False
     7.812500e-04 -8.000000e-01 4.000000      4    -1.491018   0.8     False
     8.300781e-04 -8.500000e-01 4.000000      4    -1.460720   0.8     False
     8.789062e-04 -9.000000e-01 4.000000      4    -1.444205   0.8     False
     9.277344e-04 -9.500000e-01 4.000000      4    -1.443972   0.8     False
     9.765625e-04 -1.000000e+00 3.661515      4    -1.443739   0.8     False
     1.025391e-03 -1.050000e+00 3.661515      4    -1.443506   0.8     False
     1.074219e-03 -1.100000e+00 3.661515      4    -1.443273   0.8     False
     1.123047e-03 -1.150000e+00 3.323029      4    -1.443040   1.0      True
     1.171875e-03 -1.200000e+00 3.323029      4    -1.442807   1.0      True
     1.220703e-03 -1.250000e+00 3.661515      5    -1.242573   0.8     False
     1.269531e-03 -1.300000e+00 3.323029      5    -1.242340   0.8     False
     1.318359e-03 -1.350000e+00 3.323029      5    -1.242107   0.8     False
     1.367187e-03 -1.400000e+00 3.323029      5    -1.241874   0.8     False
     1.416016e-03 -1.450000e+00 2.984544      5    -1.241641   1.0     False
     1.464844e-03 -1.500000e+00 2.984544      5    -1.241408   1.0     False
     1.513672e-03 -1.550000e+00 3.191495      6    -1.041175   0.8     False
     1.562500e-03 -1.600000e+00 2.853010      6    -1.040941   0.8     False
     1.611328e-03 -1.650000e+00 2.853010      6    -1.040708   0.8     False
     1.660156e-03 -1.700000e+00 2.853010      6    -1.040475   0.8     False
     1.708984e-03 -1.750000e+00 2.685773      7    -0.840242   1.0     False
     1.757812e-03 -1.800000e+00 2.685773      7    -0.840009   1.0     False
     1.806641e-03 -1.850000e+00 2.685773      7    -0.839776   1.0     False
     1.855469e-03 -1.900000e+00 2.685773      7    -0.839543   0.8     False
     1.904297e-03 -1.950000e+00 2.685773      7    -0.839310   0.8     False
     1.953125e-03 -2.000000e+00 2.685773      7    -0.839076   0.8     False
     2.001953e-03 -2.050000e+00 2.661515      8    -0.638843   0.8     False
     2.050781e-03 -2.100000e+00 2.661515      8    -0.638610   0.8     False
     2.099609e-03 -2.150000e+00 2.661515      8    -0.638377   0.8     False
     2.148437e-03 -2.200000e+00 2.323029      8    -0.638144   0.8     False
     2.197266e-03 -2.250000e+00 2.661515      8    -0.637911   0.8     False
     2.246094e-03 -2.300000e+00 2.661515      8    -0.637678   0.8     False
     2.294922e-03 -2.350000e+00 2.661515      9    -0.437444   0.8     False
     2.343750e-03 -2.400000e+00 2.661515      9    -0.437211   0.8     False
     2.392578e-03 -2.450000e+00 2.661515      9    -0.436978   0.8     False
     2.441406e-03 -2.500000e+00 2.323029      9    -0.436745   0.8     False
     2.490234e-03 -2.550000e+00 2.661515      9    -0.436512   0.8     False
     2.539062e-03 -2.600000e+00 2.661515      9    -0.436279   0.8     False
     2.587891e-03 -2.650000e+00 2.661515     10    -0.236046   0.8     False
     2.636719e-03 -2.700000e+00 2.661515     10    -0.235812   0.8     False
     2.685547e-03 -2.750000e+00 2.661515     10    -0.235579   0.8     False
     2.734375e-03 -2.800000e+00 2.661515     10    -0.235346   0.8     False
     2.783203e-03 -2.850000e+00 2.323029     10    -0.235113   0.8     False
     2.832031e-03 -2.900000e+00 2.661515     10    -0.234880   0.8     False
     2.880859e-03 -2.950000e+00 2.661515     11    -0.034647   0.8     False
     2.929687e-03 -3.000000e+00 2.661515     11    -0.034414   0.8     False
     2.978516e-03 -3.050000e+00 2.661515     11    -0.034180   0.8     False
     3.027344e-03 -3.100000e+00 2.661515     11    -0.033947   0.8     False
     3.076172e-03 -3.150000e+00 2.323029     11    -0.033714   0.8     False
     3.125000e-03 -3.200000e+00 2.323029     11    -0.033481   0.8     False
     3.173828e-03 -3.250000e+00 2.661515     12     0.166752   0.8     False
     3.222656e-03 -3.300000e+00 2.661515     12     0.166985   0.8     False
     3.271484e-03 -3.350000e+00 2.661515     12     0.167218   0.8     False
     3.320312e-03 -3.400000e+00 2.661515     12     0.167451   0.8     False
     3.369141e-03 -3.450000e+00 2.323029     12     0.167685   0.8     False
     3.417969e-03 -3.500000e+00 2.191495     13     0.367918   1.0     False
     3.466797e-03 -3.550000e+00 2.661515     13     0.368151   0.8     False
     3.515625e-03 -3.600000e+00 2.661515     13     0.368384   0.8     False
     3.564453e-03 -3.650000e+00 2.661515     13     0.368617   0.8     False
     3.613281e-03 -3.700000e+00 2.661515     13     0.368850   0.8     False
     3.662109e-03 -3.750000e+00 2.323029     13     0.369083   0.8     False
     3.710937e-03 -3.800000e+00 2.191495     14     0.569317   1.0     False
     3.759766e-03 -3.850000e+00 2.191495     14     0.569550   1.0     False
     3.808594e-03 -3.900000e+00 2.661515     14     0.569783   0.8     False
     3.857422e-03 -3.950000e+00 2.661515     14     0.570016   0.8     False
     3.906250e-03 -4.000000e+00 2.661515     14     0.570249   0.8     False
     3.955078e-03 -4.050000e+00 2.323029     14     0.570482   0.8     False
     4.003906e-03 -4.100000e+00 2.191495     15     0.770715   1.0     False
     4.052734e-03 -4.150000e+00 2.191495     15     0.770949   1.0     False
     4.101562e-03 -4.200000e+00 2.191495     15     0.771182   1.0     False
     4.150391e-03 -4.250000e+00 2.661515     15     0.771415   0.8     False
     4.199219e-03 -4.300000e+00 2.661515     15     0.771648   0.8     False
     4.248047e-03 -4.350000e+00 2.323029     15     0.771881   0.8     False
     4.296875e-03 -4.400000e+00 2.191495     16     0.972114   1.0     False
     4.345703e-03 -4.450000e+00 2.191495     16     0.972347   1.0     False
     4.394531e-03 -4.500000e+00 2.191495     16     0.972581   1.0     False
     4.443359e-03 -4.550000e+00 2.661515     16     0.972814   0.8     False
     4.492187e-03 -4.600000e+00 2.661515     16     0.973047   0.8     False
     4.541016e-03 -4.650000e+00 2.661515     16     0.973280   0.8     False
     4.589844e-03 -4.700000e+00 2.191495     17     1.173513   1.0     False
     4.638672e-03 -4.750000e+00 2.191495     17     1.173746   1.0     False
     4.687500e-03 -4.800000e+00 2.191495     17     1.173979   1.0     False
     4.736328e-03 -4.850000e+00 2.191495     17     1.174213   1.0     False
     4.785156e-03 -4.900000e+00 2.661515     17     1.174446   0.8     False
     4.833984e-03 -4.950000e+00 2.661515     17     1.174679   0.8     False
       slope  intercept  maxval  index  d_bestguess  fwhm  multimax
    0.000537      -0.55     4.0      4    -1.642504   0.8     False
    Keeping 4 out of 4, skippin 0 because of null values in columns d_rot_tmp
    median: -1.671795
    75.000000 percentile cut: max residual for cut: 0.084521
    median: -1.735965
    i:00 mean:-1.735965(0.072502) stdev:0.102533(0.041859) X2norm:0.79 Nchanged:0 Ngood:3 Nclip:1

    mean: -1.657983
    i:01 mean:-1.657983(0.056113) stdev:0.097190(0.034362) X2norm:1.00 Nchanged:1 Ngood:4 Nclip:0

    mean: -1.657983
    i:02 mean:-1.657983(0.056113) stdev:0.097190(0.034362) X2norm:1.00 Nchanged:0 Ngood:4 Nclip:0
    /Users/jpierel/miniconda3/envs/tweakreg/lib/python3.10/site-packages/astropy/wcs/wcs.py:725: FITSFixedWarning: 'obsfix' made the change 'Set OBSGEO-L to   -72.164999 from OBSGEO-[XYZ].
    Set OBSGEO-B to   -38.353872 from OBSGEO-[XYZ].
    Set OBSGEO-H to 1740894174.999 from OBSGEO-[XYZ]'.
      warnings.warn(





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  55.247 seconds)


.. _sphx_glr_download_examples_plot_b_nircam.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_b_nircam.py <plot_b_nircam.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_b_nircam.ipynb <plot_b_nircam.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
